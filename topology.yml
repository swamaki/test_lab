name: testlab

mgmt:
  network: custom_net
  bridge: mybridge
  ipv4-subnet: 192.168.223.0/24

# # working
# mgmt:
#   network: dual_custom_net
#   bridge: custom_bridge
#   ipv4-subnet: 192.168.223.0/24

topology:
  kinds:
    ceos:
      # startup-config: ./device_bootstrap/ceos.cfg.tpl
      image: ceosimage:4.34.3M
      # exec:
      #   - sleep 10
      #   - FastCli -p 15 -c 'security pki key generate rsa 4096 eAPI.key'
      #   - FastCli -p 15 -c 'security pki certificate generate self-signed eAPI.crt key eAPI.key generate rsa 4096 validity 30000 parameters common-name eAPI'

  nodes:
    CA1-SPINE1:
      kind: ceos
      mgmt-ipv4: 192.168.223.11
      startup-config: ./device_bootstrap/initial_configs/CA1-SPINE1.cfg
      binds:
        - ./device_bootstrap/sn/CA1-SPINE1.txt:/mnt/flash/ceos-config:ro
    CA1-SPINE2:
      kind: ceos
      mgmt-ipv4: 192.168.223.12
      startup-config: ./device_bootstrap/initial_configs/CA1-SPINE2.cfg
      binds:
        - ./device_bootstrap/sn/CA1-SPINE2.txt:/mnt/flash/ceos-config:ro
    CA1-LEAF1A:
      kind: ceos
      mgmt-ipv4: 192.168.223.101
      startup-config: ./device_bootstrap/initial_configs/CA1-LEAF1A.cfg
      binds:
        - ./device_bootstrap/sn/CA1-LEAF1A.txt:/mnt/flash/ceos-config:ro
    CA1-LEAF1B:
      kind: ceos
      mgmt-ipv4: 192.168.223.102
      startup-config: ./device_bootstrap/initial_configs/CA1-LEAF1B.cfg
      binds:
        - ./device_bootstrap/sn/CA1-LEAF1B.txt:/mnt/flash/ceos-config:ro

  links:
    - endpoints: ["CA1-SPINE1:eth7", "CA1-SPINE2:eth7"]
    - endpoints: ["CA1-SPINE1:eth8", "CA1-SPINE2:eth8"]

    - endpoints: ["CA1-SPINE1:eth1", "CA1-LEAF1A:eth1"]
    - endpoints: ["CA1-SPINE1:eth2", "CA1-LEAF1B:eth1"]

    - endpoints: ["CA1-SPINE2:eth1", "CA1-LEAF1A:eth2"]
    - endpoints: ["CA1-SPINE2:eth2", "CA1-LEAF1B:eth2"]

    - endpoints: ["CA1-LEAF1A:eth7", "CA1-LEAF1B:eth7"]
    - endpoints: ["CA1-LEAF1A:eth8", "CA1-LEAF1B:eth8"]

    - type: dummy
      endpoint:
        node: "CA1-LEAF1A"
        interface: "eth6"
    - type: dummy
      endpoint:
        node: "CA1-LEAF1A"
        interface: "eth9"
    - type: dummy
      endpoint:
        node: "CA1-LEAF1B"
        interface: "eth6"
    - type: dummy
      endpoint:
        node: "CA1-LEAF1B"
        interface: "eth9"